<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-82213539-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-82213539-2');
</script>
    <title>7.5 Advanced GORM Features 3.1.13</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        The Grails Framework
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/introduction.html"><strong>1</strong><span>Introduction</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/gettingStarted.html"><strong>2</strong><span>Getting Started</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/upgrading.html"><strong>3</strong><span>Upgrading</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/conf.html"><strong>4</strong><span>Configuration</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/commandLine.html"><strong>5</strong><span>The Command Line</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/profiles.html"><strong>6</strong><span>Application Profiles</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/GORM.html"><strong>7</strong><span>Object Relational Mapping (GORM)</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/theWebLayer.html"><strong>8</strong><span>The Web Layer</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/traits.html"><strong>9</strong><span>Traits</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/webServices.html"><strong>10</strong><span>Web Services</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/async.html"><strong>11</strong><span>Asynchronous Programming</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/validation.html"><strong>12</strong><span>Validation</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/services.html"><strong>13</strong><span>The Service Layer</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/staticTypeCheckingAndCompilation.html"><strong>14</strong><span>Static Type Checking And Compilation</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/testing.html"><strong>15</strong><span>Testing</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/i18n.html"><strong>16</strong><span>Internationalization</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/security.html"><strong>17</strong><span>Security</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/plugins.html"><strong>18</strong><span>Plugins</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/spring.html"><strong>19</strong><span>Grails and Spring</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/hibernate.html"><strong>20</strong><span>Grails and Hibernate</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/scaffolding.html"><strong>21</strong><span>Scaffolding</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/deployment.html"><strong>22</strong><span>Deployment</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/contributing.html"><strong>23</strong><span>Contributing to Grails</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
            <li class="separator selected">
                <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../../guide/profiles.html">&lt;&lt; <strong>6</strong><span>Application Profiles</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../../guide/theWebLayer.html"><strong>8</strong><span>The Web Layer</span> >></a></div>
                


                <div class="project">
                    <h1>7.5 Advanced GORM Features</h1>

                    <p><strong>Version:</strong> 3.1.13</p>
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#eventsAutoTimestamping"><strong>7.1</strong><span>Events and Auto Timestamping</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#ormdsl"><strong>7.2</strong><span>Custom ORM Mapping</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#tableAndColumnNames"><strong>7.2.1</strong><span>Table and Column Names</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#caching"><strong>7.2.2</strong><span>Caching Strategy</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#inheritanceStrategies"><strong>7.2.3</strong><span>Inheritance Strategies</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#identity"><strong>7.2.4</strong><span>Custom Database Identity</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#compositePrimaryKeys"><strong>7.2.5</strong><span>Composite Primary Keys</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#databaseIndices"><strong>7.2.6</strong><span>Database Indices</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#optimisticLockingAndVersioning"><strong>7.2.7</strong><span>Optimistic Locking and Versioning</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#fetchingDSL"><strong>7.2.8</strong><span>Eager and Lazy Fetching</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#customCascadeBehaviour"><strong>7.2.9</strong><span>Custom Cascade Behaviour</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#customHibernateTypes"><strong>7.2.10</strong><span>Custom Hibernate Types</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#derivedProperties"><strong>7.2.11</strong><span>Derived Properties</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#customNamingStrategy"><strong>7.2.12</strong><span>Custom Naming Strategy</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#defaultSortOrder"><strong>7.3</strong><span>Default Sort Order</span></a>
                    </div>
                    
                </div>
                

                
<a name="5.5 Advanced GORM Features"><!-- Legacy link --></a>
<h2 id="advancedGORMFeatures">7.5 Advanced GORM Features</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The following sections cover more advanced usages of GORM including caching, custom mapping and events.</p>
</div>

<a name="5.5.1 Events and Auto Timestamping"><!-- Legacy link --></a>
<h2 id="eventsAutoTimestamping">7.5.1 Events and Auto Timestamping</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/eventsAutoTimestamping.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>GORM supports the registration of events as methods that get fired when certain events occurs such as deletes, inserts and updates. The following is a list of supported events:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>beforeInsert</code> - Executed before an object is initially persisted to the database.  If you return false, the insert will be cancelled.</p>
</li>
<li>
<p><code>beforeUpdate</code> - Executed before an object is updated.  If you return false, the update will be cancelled.</p>
</li>
<li>
<p><code>beforeDelete</code> - Executed before an object is deleted.  If you return false, the delete will be cancelled.</p>
</li>
<li>
<p><code>beforeValidate</code> - Executed before an object is validated</p>
</li>
<li>
<p><code>afterInsert</code> - Executed after an object is persisted to the database</p>
</li>
<li>
<p><code>afterUpdate</code> - Executed after an object has been updated</p>
</li>
<li>
<p><code>afterDelete</code> - Executed after an object has been deleted</p>
</li>
<li>
<p><code>onLoad</code> - Executed when an object is loaded from the database</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To add an event simply register the relevant method with your domain class.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Do not attempt to flush the session within an event (such as with <code>obj.save(flush:true)</code>). Since events are fired during flushing this will cause a StackOverflowError.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_event_types">Event types</h3>
<div class="sect3">
<h4 id="_the_beforeinsert_event">The beforeInsert event</h4>
<div class="paragraph">
<p>Fired before an object is saved to the database</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
   <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">Date</span> NULL_DATE = <span class="keyword">new</span> <span class="predefined-type">Date</span>(<span class="integer">0</span>)

   <span class="predefined-type">String</span> firstName
   <span class="predefined-type">String</span> lastName
   <span class="predefined-type">Date</span> signupDate = NULL_DATE

   <span class="keyword">def</span> <span class="function">beforeInsert</span>() {
      <span class="keyword">if</span> (signupDate == NULL_DATE) {
         signupDate = <span class="keyword">new</span> <span class="predefined-type">Date</span>()
      }
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_the_beforeupdate_event">The beforeUpdate event</h4>
<div class="paragraph">
<p>Fired before an existing object is updated</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {

   <span class="keyword">def</span> securityService

   <span class="predefined-type">String</span> firstName
   <span class="predefined-type">String</span> lastName
   <span class="predefined-type">String</span> lastUpdatedBy

   <span class="directive">static</span> constraints = {
      lastUpdatedBy <span class="key">nullable</span>: <span class="predefined-constant">true</span>
   }

   <span class="keyword">def</span> <span class="function">beforeUpdate</span>() {
      lastUpdatedBy = securityService.currentAuthenticatedUsername()
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_the_beforedelete_event">The beforeDelete event</h4>
<div class="paragraph">
<p>Fired before an object is deleted.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
   <span class="predefined-type">String</span> name

   <span class="keyword">def</span> <span class="function">beforeDelete</span>() {
      ActivityTrace.withNewSession {
         <span class="keyword">new</span> ActivityTrace(<span class="key">eventName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Person Deleted</span><span class="delimiter">&quot;</span></span>, <span class="key">data</span>: name).save()
      }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice the usage of <code>withNewSession</code> method above. Since events are triggered whilst Hibernate is flushing using persistence methods like <code>save()</code> and <code>delete()</code> won&#8217;t result in objects being saved unless you run your operations with a new <code>Session</code>.</p>
</div>
<div class="paragraph">
<p>Fortunately the <code>withNewSession</code> method lets you share the same transactional JDBC connection even though you&#8217;re using a different underlying <code>Session</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_beforevalidate_event">The beforeValidate event</h4>
<div class="paragraph">
<p>Fired before an object is validated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
   <span class="predefined-type">String</span> name

   <span class="directive">static</span> constraints = {
       name <span class="key">size</span>: <span class="integer">5</span>..<span class="integer">45</span>
   }

   <span class="keyword">def</span> <span class="function">beforeValidate</span>() {
       name = name?.trim()
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>beforeValidate</code> method is run before any validators are run.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Validation may run more often than you think. It is triggered by the <code>validate()</code> and <code>save()</code> methods as you&#8217;d expect, but it is also typically triggered just before the view is rendered as well. So when writing <code>beforeValidate()</code> implementations, make sure that they can handle being called multiple times with the same property values.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>GORM supports an overloaded version of <code>beforeValidate</code> which accepts a <code>List</code> parameter which may include
the names of the properties which are about to be validated.  This version of <code>beforeValidate</code> will be called
when the <code>validate</code> method has been invoked and passed a <code>List</code> of property names as an argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
   <span class="predefined-type">String</span> name
   <span class="predefined-type">String</span> town
   <span class="predefined-type">Integer</span> age

   <span class="directive">static</span> constraints = {
       name <span class="key">size</span>: <span class="integer">5</span>..<span class="integer">45</span>
       age <span class="key">range</span>: <span class="integer">4</span>..<span class="integer">99</span>
   }

   <span class="keyword">def</span> <span class="function">beforeValidate</span>(<span class="predefined-type">List</span> propertiesBeingValidated) {
      <span class="comment">// do pre validation work based on propertiesBeingValidated</span>
   }
}

<span class="keyword">def</span> p = <span class="keyword">new</span> Person(<span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Jacob Brown</span><span class="delimiter">'</span></span>, <span class="key">age</span>: <span class="integer">10</span>)
p.validate([<span class="string"><span class="delimiter">'</span><span class="content">age</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>])</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Note that when <code>validate</code> is triggered indirectly because of a call to the <code>save</code> method that
the <code>validate</code> method is being invoked with no arguments, not a <code>List</code> that includes all of
the property names.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Either or both versions of <code>beforeValidate</code> may be defined in a domain class.  GORM will
prefer the <code>List</code> version if a <code>List</code> is passed to <code>validate</code> but will fall back on the
no-arg version if the <code>List</code> version does not exist.  Likewise, GORM will prefer the
no-arg version if no arguments are passed to <code>validate</code> but will fall back on the
<code>List</code> version if the no-arg version does not exist.  In that case, <code>null</code> is passed to <code>beforeValidate</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_onload_beforeload_event">The onLoad/beforeLoad event</h4>
<div class="paragraph">
<p>Fired immediately before an object is loaded from the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
   <span class="predefined-type">String</span> name
   <span class="predefined-type">Date</span> dateCreated
   <span class="predefined-type">Date</span> lastUpdated

   <span class="keyword">def</span> <span class="function">onLoad</span>() {
      log.debug <span class="string"><span class="delimiter">&quot;</span><span class="content">Loading </span><span class="inline"><span class="inline-delimiter">${</span>id<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>beforeLoad()</code> is effectively a synonym for <code>onLoad()</code>, so only declare one or the other.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_afterload_event">The afterLoad event</h4>
<div class="paragraph">
<p>Fired immediately after an object is loaded from the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
   <span class="predefined-type">String</span> name
   <span class="predefined-type">Date</span> dateCreated
   <span class="predefined-type">Date</span> lastUpdated

   <span class="keyword">def</span> <span class="function">afterLoad</span>() {
      name = <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm loaded</span><span class="delimiter">&quot;</span></span>
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_custom_event_listeners">Custom Event Listeners</h4>
<div class="paragraph">
<p>As of Grails 2.0 there is a new API for plugins and applications to register and listen for persistence events. This API is not tied to Hibernate and also works for other persistence plugins such as the <a href="https://grails.org/plugins.html#plugin/mongodb">MongoDB plugin for GORM</a>.</p>
</div>
<div class="paragraph">
<p>To use this API you need to subclass <code>AbstractPersistenceEventListener</code> (in package <em>org.grails.datastore.mapping.engine.event</em>) and implement the methods <code>onPersistenceEvent</code> and <code>supportsEventType</code>. You also must provide a reference to the datastore to the listener.  The simplest possible implementation can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="directive">public</span> MyPersistenceListener(<span class="directive">final</span> Datastore datastore) {
    <span class="local-variable">super</span>(datastore)
}

<span class="annotation">@Override</span>
<span class="directive">protected</span> <span class="type">void</span> onPersistenceEvent(<span class="directive">final</span> AbstractPersistenceEvent event) {
    <span class="keyword">switch</span>(event.eventType) {
        <span class="keyword">case</span> <span class="key">PreInsert</span>:
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">PRE INSERT </span><span class="inline"><span class="inline-delimiter">${</span>event.entityObject<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
        <span class="keyword">break</span>
        <span class="keyword">case</span> <span class="key">PostInsert</span>:
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">POST INSERT </span><span class="inline"><span class="inline-delimiter">${</span>event.entityObject<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
        <span class="keyword">break</span>
        <span class="keyword">case</span> <span class="key">PreUpdate</span>:
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">PRE UPDATE </span><span class="inline"><span class="inline-delimiter">${</span>event.entityObject<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
        <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="key">PostUpdate</span>:
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">POST UPDATE </span><span class="inline"><span class="inline-delimiter">${</span>event.entityObject<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
        <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="key">PreDelete</span>:
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">PRE DELETE </span><span class="inline"><span class="inline-delimiter">${</span>event.entityObject<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
        <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="key">PostDelete</span>:
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">POST DELETE </span><span class="inline"><span class="inline-delimiter">${</span>event.entityObject<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
        <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="key">PreLoad</span>:
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">PRE LOAD </span><span class="inline"><span class="inline-delimiter">${</span>event.entityObject<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
        <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="key">PostLoad</span>:
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">POST LOAD </span><span class="inline"><span class="inline-delimiter">${</span>event.entityObject<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
        <span class="keyword">break</span>;
    }
}

<span class="annotation">@Override</span>
<span class="directive">public</span> <span class="type">boolean</span> supportsEventType(<span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> ApplicationEvent&gt; eventType) {
    <span class="keyword">return</span> <span class="predefined-constant">true</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>AbstractPersistenceEvent</code> class has many subclasses (<code>PreInsertEvent</code>, <code>PostInsertEvent</code> etc.) that provide further information specific to the event. A <code>cancel()</code> method is also provided on the event which allows you to veto an insert, update or delete operation.</p>
</div>
<div class="paragraph">
<p>Once you have created your event listener you need to register it with the <code>ApplicationContext</code>. This can be done in <code>BootStrap.groovy</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> grailsApplication

<span class="keyword">def</span> init = {
    <span class="keyword">def</span> applicationContext = grailsApplication.mainContext
    applicationContext.eventTriggeringInterceptor.datastores.each { k, datastore -&gt;
        applicationContext.addApplicationListener <span class="keyword">new</span> MyPersistenceListener(datastore)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or use this in a plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> doWithApplicationContext = { applicationContext -&gt;
    grailsApplication.mainContext.eventTriggeringInterceptor.datastores.each { k, datastore -&gt;
        applicationContext.addApplicationListener <span class="keyword">new</span> MyPersistenceListener(datastore)
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_hibernate_events">Hibernate Events</h4>
<div class="paragraph">
<p>It is generally encouraged to use the non-Hibernate specific API described above, but if you need access to more detailed Hibernate events then you can define custom Hibernate-specific event listeners.</p>
</div>
<div class="paragraph">
<p>You can also register event handler classes in an application&#8217;s <code>grails-app/conf/spring/resources.groovy</code> or in the <code>doWithSpring</code> closure in a plugin descriptor by registering a Spring bean named <code>hibernateEventListeners</code>. This bean has one property, <code>listenerMap</code> which specifies the listeners to register for various Hibernate events.</p>
</div>
<div class="paragraph">
<p>The values of the Map are instances of classes that implement one or more Hibernate listener interfaces. You can use one class that implements all of the required interfaces, or one concrete class per interface, or any combination. The valid Map keys and corresponding interfaces are listed here:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Interface</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">auto-flush</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/AutoFlushEventListener.html">AutoFlushEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">merge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/MergeEventListener.html">MergeEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">create</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PersistEventListener.html">PersistEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">create-onflush</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PersistEventListener.html">PersistEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/DeleteEventListener.html">DeleteEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dirty-check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/DirtyCheckEventListener.html">DirtyCheckEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">evict</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/EvictEventListener.html">EvictEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flush</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/FlushEventListener.html">FlushEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flush-entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/FlushEntityEventListener.html">FlushEntityEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">load</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/LoadEventListener.html">LoadEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">load-collection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/InitializeCollectionEventListener.html">InitializeCollectionEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/LockEventListener.html">LockEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">refresh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/RefreshEventListener.html">RefreshEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">replicate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/ReplicateEventListener.html">ReplicateEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">save-update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/SaveOrUpdateEventListener.html">SaveOrUpdateEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">save</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/SaveOrUpdateEventListener.html">SaveOrUpdateEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/SaveOrUpdateEventListener.html">SaveOrUpdateEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-load</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PreLoadEventListener.html">PreLoadEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PreUpdateEventListener.html">PreUpdateEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PreDeleteEventListener.html">PreDeleteEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-insert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PreInsertEventListener.html">PreInsertEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-collection-recreate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PreCollectionRecreateEventListener.html">PreCollectionRecreateEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-collection-remove</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PreCollectionRemoveEventListener.html">PreCollectionRemoveEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-collection-update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PreCollectionUpdateEventListener.html">PreCollectionUpdateEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-load</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PostLoadEventListener.html">PostLoadEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PostUpdateEventListener.html">PostUpdateEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PostDeleteEventListener.html">PostDeleteEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-insert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PostInsertEventListener.html">PostInsertEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-commit-update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PostUpdateEventListener.html">PostUpdateEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-commit-delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PostDeleteEventListener.html">PostDeleteEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-commit-insert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PostInsertEventListener.html">PostInsertEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-collection-recreate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PostCollectionRecreateEventListener.html">PostCollectionRecreateEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-collection-remove</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PostCollectionRemoveEventListener.html">PostCollectionRemoveEventListener</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-collection-update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/event/PostCollectionUpdateEventListener.html">PostCollectionUpdateEventListener</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, you could register a class <code>AuditEventListener</code> which implements <code>PostInsertEventListener</code>, <code>PostUpdateEventListener</code>, and <code>PostDeleteEventListener</code> using the following in an application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">beans = {

   auditListener(AuditEventListener)

   hibernateEventListeners(HibernateEventListeners) {
      listenerMap = [<span class="string"><span class="delimiter">'</span><span class="content">post-insert</span><span class="delimiter">'</span></span>: auditListener,
                     <span class="string"><span class="delimiter">'</span><span class="content">post-update</span><span class="delimiter">'</span></span>: auditListener,
                     <span class="string"><span class="delimiter">'</span><span class="content">post-delete</span><span class="delimiter">'</span></span>: auditListener]
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or use this in a plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> doWithSpring = {

   auditListener(AuditEventListener)

   hibernateEventListeners(HibernateEventListeners) {
      listenerMap = [<span class="string"><span class="delimiter">'</span><span class="content">post-insert</span><span class="delimiter">'</span></span>: auditListener,
                     <span class="string"><span class="delimiter">'</span><span class="content">post-update</span><span class="delimiter">'</span></span>: auditListener,
                     <span class="string"><span class="delimiter">'</span><span class="content">post-delete</span><span class="delimiter">'</span></span>: auditListener]
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_automatic_timestamping">Automatic timestamping</h4>
<div class="paragraph">
<p>If you define a <code>dateCreated</code> property it will be set to the current date for you when you create new instances. Likewise, if you define a <code>lastUpdated</code> property it will be automatically be updated for you when you change persistent instances.</p>
</div>
<div class="paragraph">
<p>If this is not the behaviour you want you can disable this feature with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
   <span class="predefined-type">Date</span> dateCreated
   <span class="predefined-type">Date</span> lastUpdated
   <span class="directive">static</span> mapping = {
      autoTimestamp <span class="predefined-constant">false</span>
   }
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If you have <code>nullable: false</code> constraints on either <code>dateCreated</code> or <code>lastUpdated</code>, your domain instances will fail validation - probably not what you want. Omit constraints from these properties unless you disable automatic timestamping.
</td>
</tr>
</table>
</div>
</div>
</div>

<a name="5.5.2 Custom ORM Mapping"><!-- Legacy link --></a>
<h2 id="ormdsl">7.5.2 Custom ORM Mapping</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Grails domain classes can be mapped onto many legacy schemas with an Object Relational Mapping DSL (domain specific language). The following sections takes you through what is possible with the ORM DSL.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
None of this is necessary if you are happy to stick to the conventions defined by GORM for table names, column names and so on. You only needs this functionality if you need to tailor the way GORM maps onto legacy schemas or configures caching
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Custom mappings are defined using a static <code>mapping</code> block defined within your domain class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ...
    static mapping = {
        version <span class="predefined-constant">false</span>
        autoTimestamp <span class="predefined-constant">false</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also configure global mappings in <code>application.groovy</code> (or an external config file) using this setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails.gorm.default.mapping = {
    version <span class="predefined-constant">false</span>
    autoTimestamp <span class="predefined-constant">false</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It has the same syntax as the standard <code>mapping</code> block but it applies to all your domain classes! You can then override these defaults within the <code>mapping</code> block of a domain class.</p>
</div>

<a name="5.5.2.1 Table and Column Names"><!-- Legacy link --></a>
<h2 id="tableAndColumnNames">7.5.2.1 Table and Column Names</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl/tableAndColumnNames.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="sect3">
<h4 id="_table_names">Table names</h4>
<div class="paragraph">
<p>The database table name which the class maps to can be customized using the <code>table</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ...
    static mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case the class would be mapped to a table called <code>people</code> instead of the default name of <code>person</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_column_names">Column names</h4>
<div class="paragraph">
<p>It is also possible to customize the mapping for individual columns onto the database. For example to change the name you can do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {

    <span class="predefined-type">String</span> firstName

    <span class="directive">static</span> mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
        firstName <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">First_Name</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here <code>firstName</code> is a dynamic method within the <code>mapping</code> Closure that has a single Map parameter. Since its name corresponds to a domain class persistent field, the parameter values (in this case just <code>"column"</code>) are used to configure the mapping for that property.</p>
</div>
</div>
<div class="sect3">
<h4 id="_column_type">Column type</h4>
<div class="paragraph">
<p>GORM supports configuration of Hibernate types with the DSL using the type attribute. This includes specifying user types that implement the Hibernate <a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/usertype/UserType.html">org.hibernate.usertype.UserType</a> interface, which allows complete customization of how a type is persisted. As an example if you had a <code>PostCodeType</code> you could use it as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Address</span> {

    <span class="predefined-type">String</span> number
    <span class="predefined-type">String</span> postCode

    <span class="directive">static</span> mapping = {
        postCode <span class="key">type</span>: PostCodeType
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively if you just wanted to map it to one of Hibernate&#8217;s basic types other than the default chosen by Grails you could use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Address</span> {

    <span class="predefined-type">String</span> number
    <span class="predefined-type">String</span> postCode

    <span class="directive">static</span> mapping = {
        postCode <span class="key">type</span>: <span class="string"><span class="delimiter">'</span><span class="content">text</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would make the <code>postCode</code> column map to the default large-text type for the database you&#8217;re using (for example TEXT or CLOB).</p>
</div>
<div class="paragraph">
<p>See the Hibernate documentation regarding <a href="http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/mapping.html#mapping-types-basictypes">Basic Types</a> for further information.</p>
</div>
</div>
<div class="sect3">
<h4 id="_many_to_one_one_to_one_mappings">Many-to-One/One-to-One Mappings</h4>
<div class="paragraph">
<p>In the case of associations it is also possible to configure the foreign keys used to map associations. In the case of a many-to-one or one-to-one association this is exactly the same as any regular column. For example consider the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {

    <span class="predefined-type">String</span> firstName
    Address address

    <span class="directive">static</span> mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
        firstName <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">First_Name</span><span class="delimiter">'</span></span>
        address <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">Person_Address_Id</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default the <code>address</code> association would map to a foreign key column called <code>address_id</code>. By using the above mapping we have changed the name of the foreign key column to <code>Person_Adress_Id</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_one_to_many_mapping">One-to-Many Mapping</h4>
<div class="paragraph">
<p>With a bidirectional one-to-many you can change the foreign key column used by changing the column name on the many side of the association as per the example in the previous section on one-to-one associations. However, with unidirectional associations the foreign key needs to be specified on the association itself. For example given a unidirectional one-to-many relationship between <code>Person</code> and <code>Address</code> the following code will change the foreign key in the <code>address</code> table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {

    <span class="predefined-type">String</span> firstName

    <span class="directive">static</span> hasMany = [<span class="key">addresses</span>: Address]

    <span class="directive">static</span> mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
        firstName <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">First_Name</span><span class="delimiter">'</span></span>
        addresses <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">Person_Address_Id</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you don&#8217;t want the column to be in the <code>address</code> table, but instead some intermediate join table you can use the <code>joinTable</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {

    <span class="predefined-type">String</span> firstName

    <span class="directive">static</span> hasMany = [<span class="key">addresses</span>: Address]

    <span class="directive">static</span> mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
        firstName <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">First_Name</span><span class="delimiter">'</span></span>
        addresses <span class="key">joinTable</span>: [<span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Person_Addresses</span><span class="delimiter">'</span></span>,
                              <span class="key">key</span>: <span class="string"><span class="delimiter">'</span><span class="content">Person_Id</span><span class="delimiter">'</span></span>,
                              <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">Address_Id</span><span class="delimiter">'</span></span>]
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_many_to_many_mapping">Many-to-Many Mapping</h4>
<div class="paragraph">
<p>Grails, by default maps a many-to-many association using a join table. For example consider this many-to-many association:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Group</span> {
    ...
    static hasMany = [<span class="key">people</span>: Person]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ...
    static belongsTo = <span class="predefined-type">Group</span>
    <span class="directive">static</span> hasMany = [<span class="key">groups</span>: <span class="predefined-type">Group</span>]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case Grails will create a join table called <code>group_person</code> containing foreign keys called <code>person_id</code> and <code>group_id</code> referencing the <code>person</code> and <code>group</code> tables. To change the column names you can specify a column within the mappings for each class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Group</span> {
   ...
   static mapping = {
       people <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">Group_Person_Id</span><span class="delimiter">'</span></span>
   }
}
<span class="type">class</span> <span class="class">Person</span> {
   ...
   static mapping = {
       groups <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">Group_Group_Id</span><span class="delimiter">'</span></span>
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also specify the name of the join table to use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Group</span> {
   ...
   static mapping = {
       people <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">Group_Person_Id</span><span class="delimiter">'</span></span>,
              <span class="key">joinTable</span>: <span class="string"><span class="delimiter">'</span><span class="content">PERSON_GROUP_ASSOCIATIONS</span><span class="delimiter">'</span></span>
   }
}
<span class="type">class</span> <span class="class">Person</span> {
   ...
   static mapping = {
       groups <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">Group_Group_Id</span><span class="delimiter">'</span></span>,
              <span class="key">joinTable</span>: <span class="string"><span class="delimiter">'</span><span class="content">PERSON_GROUP_ASSOCIATIONS</span><span class="delimiter">'</span></span>
   }
}</code></pre>
</div>
</div>
</div>

<a name="5.5.2.2 Caching Strategy"><!-- Legacy link --></a>
<h2 id="caching">7.5.2.2 Caching Strategy</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl/caching.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="sect3">
<h4 id="_setting_up_caching">Setting up caching</h4>
<div class="paragraph">
<p><a href="http://www.hibernate.org/">Hibernate</a> features a second-level cache with a customizable cache provider. This needs to be configured in the <code>grails-app/conf/application.yml</code> file as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="key">hibernate</span>:
  <span class="key">cache</span>:
    <span class="key">use_second_level_cache</span>: <span class="predefined-constant">true</span>
    <span class="key">provider_class</span>: net.sf.ehcache.hibernate.EhCacheProvider
    <span class="key">region</span>:
       <span class="key">factory_class</span>: org.hibernate.cache.ehcache.EhCacheRegionFactory</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can customize any of these settings, for example to use a distributed caching mechanism.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For further reading on caching and in particular Hibernate&#8217;s second-level cache, refer to the <a href="http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/performance.html#performance-cache">Hibernate documentation</a> on the subject.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_caching_instances">Caching instances</h4>
<div class="paragraph">
<p>Call the <code>cache</code> method in your mapping block to enable caching with the default settings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ...
    static mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
        cache <span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will configure a 'read-write' cache that includes both lazy and non-lazy properties. You can customize this further:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ...
    static mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
        cache <span class="key">usage</span>: <span class="string"><span class="delimiter">'</span><span class="content">read-only</span><span class="delimiter">'</span></span>, <span class="key">include</span>: <span class="string"><span class="delimiter">'</span><span class="content">non-lazy</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_caching_associations">Caching associations</h4>
<div class="paragraph">
<p>As well as the ability to use Hibernate&#8217;s second level cache to cache instances you can also cache collections (associations) of objects. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {

    <span class="predefined-type">String</span> firstName

    <span class="directive">static</span> hasMany = [<span class="key">addresses</span>: Address]

    <span class="directive">static</span> mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
        version <span class="predefined-constant">false</span>
        addresses <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">Address</span><span class="delimiter">'</span></span>, <span class="key">cache</span>: <span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Address</span> {
    <span class="predefined-type">String</span> number
    <span class="predefined-type">String</span> postCode
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will enable a 'read-write' caching mechanism on the <code>addresses</code> collection. You can also use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="key">cache</span>: <span class="string"><span class="delimiter">'</span><span class="content">read-write</span><span class="delimiter">'</span></span> <span class="comment">// or 'read-only' or 'transactional'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>to further configure the cache usage.</p>
</div>
</div>
<div class="sect3">
<h4 id="_caching_queries">Caching Queries</h4>
<div class="paragraph">
<p>You can cache queries such as dynamic finders and criteria. To do so using a dynamic finder you can pass the <code>cache</code> argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> person = Person.findByFirstName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Fred</span><span class="delimiter">&quot;</span></span>, [<span class="key">cache</span>: <span class="predefined-constant">true</span>])</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In order for the results of the query to be cached, you must enable caching in your mapping as discussed in the previous section.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also cache criteria queries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> people = Person.withCriteria {
    like(<span class="string"><span class="delimiter">'</span><span class="content">firstName</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Fr%</span><span class="delimiter">'</span></span>)
    cache <span class="predefined-constant">true</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_cache_usages">Cache usages</h4>
<div class="paragraph">
<p>Below is a description of the different cache settings and their usages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>read-only</code> - If your application needs to read but never modify instances of a persistent class, a read-only cache may be used.</p>
</li>
<li>
<p><code>read-write</code> - If the application needs to update data, a read-write cache might be appropriate.</p>
</li>
<li>
<p><code>nonstrict-read-write</code> - If the application only occasionally needs to update data (i.e. if it is very unlikely that two transactions would try to update the same item simultaneously) and strict transaction isolation is not required, a <code>nonstrict-read-write</code> cache might be appropriate.</p>
</li>
<li>
<p><code>transactional</code> - The <code>transactional</code> cache strategy provides support for fully transactional cache providers such as JBoss TreeCache. Such a cache may only be used in a JTA environment and you must specify <code>hibernate.transaction.manager_lookup_class</code> in the <code>grails-app/conf/application.groovy</code> file&#8217;s <code>hibernate</code> config.</p>
</li>
</ul>
</div>
</div>

<a name="5.5.2.3 Inheritance Strategies"><!-- Legacy link --></a>
<h2 id="inheritanceStrategies">7.5.2.3 Inheritance Strategies</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl/inheritanceStrategies.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>By default GORM classes use <code>table-per-hierarchy</code> inheritance mapping. This has the disadvantage that columns cannot have a <code>NOT-NULL</code> constraint applied to them at the database level. If you would prefer to use a <code>table-per-subclass</code> inheritance strategy you can do so as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Payment</span> {
    <span class="predefined-type">Integer</span> amount

    <span class="directive">static</span> mapping = {
        tablePerHierarchy <span class="predefined-constant">false</span>
    }
}

<span class="type">class</span> <span class="class">CreditCardPayment</span> <span class="directive">extends</span> Payment {
    <span class="predefined-type">String</span> cardNumber
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The mapping of the root <code>Payment</code> class specifies that it will not be using <code>table-per-hierarchy</code> mapping for all child classes.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can use a <code>table-per-concrete-class</code> inheritance strategy where each concrete class will have its own table with columns for all properties of the class, including inherited properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Payment</span> {
    <span class="predefined-type">Integer</span> amount

    <span class="directive">static</span> mapping = {
        tablePerConcreteClass <span class="predefined-constant">true</span>
    }
}

<span class="type">class</span> <span class="class">CreditCardPayment</span> <span class="directive">extends</span> Payment {
    <span class="predefined-type">String</span> cardNumber
}</code></pre>
</div>
</div>

<a name="5.5.2.4 Custom Database Identity"><!-- Legacy link --></a>
<h2 id="identity">7.5.2.4 Custom Database Identity</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl/identity.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can customize how GORM generates identifiers for the database using the DSL. By default GORM relies on the native database mechanism for generating ids. This is by far the best approach, but there are still many schemas that have different approaches to identity.</p>
</div>
<div class="paragraph">
<p>To deal with this Hibernate defines the concept of an id generator. You can customize the id generator and the column it maps to as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ...
    static mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
        version <span class="predefined-constant">false</span>
        id <span class="key">generator</span>: <span class="string"><span class="delimiter">'</span><span class="content">hilo</span><span class="delimiter">'</span></span>,
           <span class="key">params</span>: [<span class="key">table</span>: <span class="string"><span class="delimiter">'</span><span class="content">hi_value</span><span class="delimiter">'</span></span>,
                    <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">next_value</span><span class="delimiter">'</span></span>,
                    <span class="key">max_lo</span>: <span class="integer">100</span>]
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case we&#8217;re using one of Hibernate&#8217;s built in 'hilo' generators that uses a separate table to generate ids.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more information on the different Hibernate generators refer to the <a href="http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/mapping.html#mapping-declaration-id-generator">Hibernate reference documentation</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Although you don&#8217;t typically specify the <code>id</code> field (Grails adds it for you) you can still configure its mapping like the other properties. For example to customise the column for the id property you can do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ...
    static mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
        version <span class="predefined-constant">false</span>
        id <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">person_id</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>

<a name="5.5.2.5 Composite Primary Keys"><!-- Legacy link --></a>
<h2 id="compositePrimaryKeys">7.5.2.5 Composite Primary Keys</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl/compositePrimaryKeys.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>GORM supports the concept of composite identifiers (identifiers composed from 2 or more properties). It is not an approach we recommend, but is available to you if you need it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.apache.commons.lang.builder.HashCodeBuilder</span>

<span class="type">class</span> <span class="class">Person</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

    <span class="predefined-type">String</span> firstName
    <span class="predefined-type">String</span> lastName

    <span class="type">boolean</span> equals(other) {
        <span class="keyword">if</span> (!(other <span class="keyword">instanceof</span> Person)) {
            <span class="keyword">return</span> <span class="predefined-constant">false</span>
        }

        other.firstName == firstName &amp;&amp; other.lastName == lastName
    }

    <span class="type">int</span> hashCode() {
        <span class="keyword">def</span> builder = <span class="keyword">new</span> HashCodeBuilder()
        builder.append firstName
        builder.append lastName
        builder.toHashCode()
    }

    <span class="directive">static</span> mapping = {
        id <span class="key">composite</span>: [<span class="string"><span class="delimiter">'</span><span class="content">firstName</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">lastName</span><span class="delimiter">'</span></span>]
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above will create a composite id of the <code>firstName</code> and <code>lastName</code> properties of the Person class. To retrieve an instance by id you use a prototype of the object itself:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> p = Person.get(<span class="keyword">new</span> Person(<span class="key">firstName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Fred</span><span class="delimiter">&quot;</span></span>, <span class="key">lastName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Flintstone</span><span class="delimiter">&quot;</span></span>))
println p.firstName</code></pre>
</div>
</div>
<div class="paragraph">
<p>Domain classes mapped with composite primary keys must implement the <code>Serializable</code> interface and override the <code>equals</code> and <code>hashCode</code> methods, using the properties in the composite key for the calculations. The example above uses a <code>HashCodeBuilder</code> for convenience but it&#8217;s fine to implement it yourself.</p>
</div>
<div class="paragraph">
<p>Another important consideration when using composite primary keys is associations. If for example you have a many-to-one association where the foreign keys are stored in the associated table then 2 columns will be present in the associated table.</p>
</div>
<div class="paragraph">
<p>For example consider the following domain class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Address</span> {
    Person person
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case the <code>address</code> table will have an additional two columns called <code>person_first_name</code> and <code>person_last_name</code>. If you wish the change the mapping of these columns then you can do so using the following technique:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Address</span> {
    Person person
    <span class="directive">static</span> mapping = {
        columns {
                    person {
                column <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">FirstName</span><span class="delimiter">&quot;</span></span>
                column <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">LastName</span><span class="delimiter">&quot;</span></span>
                        }
        }
    }
}</code></pre>
</div>
</div>

<a name="5.5.2.6 Database Indices"><!-- Legacy link --></a>
<h2 id="databaseIndices">7.5.2.6 Database Indices</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl/databaseIndices.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To get the best performance out of your queries it is often necessary to tailor the table index definitions. How you tailor them is domain specific and a matter of monitoring usage patterns of your queries. With GORM&#8217;s DSL you can specify which columns are used in which indexes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> firstName
    <span class="predefined-type">String</span> address
    <span class="directive">static</span> mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
        version <span class="predefined-constant">false</span>
        id <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">person_id</span><span class="delimiter">'</span></span>
        firstName <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">First_Name</span><span class="delimiter">'</span></span>, <span class="key">index</span>: <span class="string"><span class="delimiter">'</span><span class="content">Name_Idx</span><span class="delimiter">'</span></span>
        address <span class="key">column</span>: <span class="string"><span class="delimiter">'</span><span class="content">Address</span><span class="delimiter">'</span></span>, <span class="key">index</span>: <span class="string"><span class="delimiter">'</span><span class="content">Name_Idx,Address_Index</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that you cannot have any spaces in the value of the <code>index</code> attribute; in this example <code>index:'Name_Idx, Address_Index'</code> will cause an error.</p>
</div>

<a name="5.5.2.7 Optimistic Locking and Versioning"><!-- Legacy link --></a>
<h2 id="optimisticLockingAndVersioning">7.5.2.7 Optimistic Locking and Versioning</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl/optimisticLockingAndVersioning.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>As discussed in the section on <a href="#locking">Optimistic and Pessimistic Locking</a>, by default GORM uses optimistic locking and automatically injects a <code>version</code> property into every class which is in turn mapped to a <code>version</code> column at the database level.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re mapping to a legacy schema that doesn&#8217;t have version columns (or there&#8217;s some other reason why you don&#8217;t want/need this feature) you can disable this with the <code>version</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ...
    static mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
        version <span class="predefined-constant">false</span>
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you disable optimistic locking you are essentially on your own with regards to concurrent updates and are open to the risk of users losing data (due to data overriding) unless you use <a href="#locking">pessimistic locking</a>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_version_columns_types">Version columns types</h4>
<div class="paragraph">
<p>By default Grails maps the <code>version</code> property as a <code>Long</code> that gets incremented by one each time an instance is updated. But Hibernate also supports using a <code>Timestamp</code>, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">java.sql.Timestamp</span>

<span class="type">class</span> <span class="class">Person</span> {

    ...
    Timestamp version

    <span class="directive">static</span> mapping = {
        table <span class="string"><span class="delimiter">'</span><span class="content">people</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There&#8217;s a slight risk that two updates occurring at nearly the same time on a fast server can end up with the same timestamp value but this risk is very low. One benefit of using a <code>Timestamp</code> instead of a <code>Long</code> is that you combine the optimistic locking and last-updated semantics into a single column.</p>
</div>
</div>

<a name="5.5.2.8 Eager and Lazy Fetching"><!-- Legacy link --></a>
<h2 id="fetchingDSL">7.5.2.8 Eager and Lazy Fetching</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl/fetchingDSL.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="sect3">
<h4 id="_lazy_collections">Lazy Collections</h4>
<div class="paragraph">
<p>As discussed in the section on <a href="#fetching">Eager and Lazy fetching</a>, GORM collections are lazily loaded by default but you can change this behaviour with the ORM DSL. There are several options available to you, but the most common ones are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>lazy: false</p>
</li>
<li>
<p>fetch: 'join'</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and they&#8217;re used like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {

    <span class="predefined-type">String</span> firstName
    Pet pet

    <span class="directive">static</span> hasMany = [<span class="key">addresses</span>: Address]

    <span class="directive">static</span> mapping = {
        addresses <span class="key">lazy</span>: <span class="predefined-constant">false</span>
        pet <span class="key">fetch</span>: <span class="string"><span class="delimiter">'</span><span class="content">join</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Address</span> {
    <span class="predefined-type">String</span> street
    <span class="predefined-type">String</span> postCode
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Pet</span> {
    <span class="predefined-type">String</span> name
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first option, <code>lazy: false</code> , ensures that when a <code>Person</code> instance is loaded, its <code>addresses</code> collection is loaded at the same time with a second SELECT. The second option is basically the same, except the collection is loaded with a JOIN rather than another SELECT. Typically you want to reduce the number of queries, so <code>fetch: 'join'</code> is the more appropriate option. On the other hand, it could feasibly be the more expensive approach if your domain model and data result in more and larger results than would otherwise be necessary.</p>
</div>
<div class="paragraph">
<p>For more advanced users, the other settings available are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>batchSize: N</p>
</li>
<li>
<p>lazy: false, batchSize: N</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>where N is an integer. These let you fetch results in batches, with one query per batch. As a simple example, consider this mapping for <code>Person</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {

    <span class="predefined-type">String</span> firstName
    Pet pet

    <span class="directive">static</span> mapping = {
        pet <span class="key">batchSize</span>: <span class="integer">5</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a query returns multiple <code>Person</code> instances, then when we access the first <code>pet</code> property, Hibernate will fetch that <code>Pet</code> plus the four next ones. You can get the same behaviour with eager loading by combining <code>batchSize</code> with the <code>lazy: false</code> option. You can find out more about these options in the <a href="http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/performance.html#performance-fetching">Hibernate user guide</a> and this <a href="http://community.jboss.org/wiki/AShortPrimerOnFetchingStrategies">primer on fetching strategies</a>. Note that ORM DSL does not currently support the "subselect" fetching strategy.</p>
</div>
</div>
<div class="sect3">
<h4 id="_lazy_single_ended_associations">Lazy Single-Ended Associations</h4>
<div class="paragraph">
<p>In GORM, one-to-one and many-to-one associations are by default lazy. Non-lazy single ended associations can be problematic when you load many entities because each non-lazy association will result in an extra SELECT statement. If the associated entities also have non-lazy associations, the number of queries grows significantly!</p>
</div>
<div class="paragraph">
<p>Use the same technique as for lazy collections to make a one-to-one or many-to-one association non-lazy/eager:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> firstName
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Address</span> {

    <span class="predefined-type">String</span> street
    <span class="predefined-type">String</span> postCode

    <span class="directive">static</span> belongsTo = [<span class="key">person</span>: Person]

    <span class="directive">static</span> mapping = {
        person <span class="key">lazy</span>: <span class="predefined-constant">false</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we configure GORM to load the associated <code>Person</code> instance (through the <code>person</code> property) whenever an <code>Address</code> is loaded.</p>
</div>
</div>
<div class="sect3">
<h4 id="_lazy_single_ended_associations_and_proxies">Lazy Single-Ended Associations and Proxies</h4>
<div class="paragraph">
<p>Hibernate uses runtime-generated proxies to facilitate single-ended lazy associations; Hibernate dynamically subclasses the entity class to create the proxy.</p>
</div>
<div class="paragraph">
<p>Consider the previous example but with a lazily-loaded <code>person</code> association: Hibernate will set the <code>person</code> property to a proxy that is a subclass of <code>Person</code>. When you call any of the getters (except for the <code>id</code> property) or setters on that proxy, Hibernate will load the entity from the database.</p>
</div>
<div class="paragraph">
<p>Unfortunately this technique can produce surprising results. Consider the following example classes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Pet</span> {
    <span class="predefined-type">String</span> name
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Dog</span> <span class="directive">extends</span> Pet {
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> name
    Pet pet
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and assume that we have a single <code>Person</code> instance with a <code>Dog</code> as the <code>pet</code>. The following code will work as you would expect:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> person = Person.get(<span class="integer">1</span>)
<span class="keyword">assert</span> person.pet <span class="keyword">instanceof</span> Dog
<span class="keyword">assert</span> Pet.get(person.petId) <span class="keyword">instanceof</span> Dog</code></pre>
</div>
</div>
<div class="paragraph">
<p>But this won&#8217;t:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> person = Person.get(<span class="integer">1</span>)
<span class="keyword">assert</span> person.pet <span class="keyword">instanceof</span> Dog
<span class="keyword">assert</span> Pet.list()[<span class="integer">0</span>] <span class="keyword">instanceof</span> Dog</code></pre>
</div>
</div>
<div class="paragraph">
<p>The second assertion fails, and to add to the confusion, this will work:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">assert</span> Pet.list()[<span class="integer">0</span>] <span class="keyword">instanceof</span> Dog</code></pre>
</div>
</div>
<div class="paragraph">
<p>What&#8217;s going on here? It&#8217;s down to a combination of how proxies work and the guarantees that the Hibernate session makes. When you load the <code>Person</code> instance, Hibernate creates a proxy for its <code>pet</code> relation and attaches it to the session. Once that happens, whenever you retrieve that <code>Pet</code> instance with a query, a <code>get()</code>, or the <code>pet</code> relation <em>within the same session</em> , Hibernate gives you the proxy.</p>
</div>
<div class="paragraph">
<p>Fortunately for us, GORM automatically unwraps the proxy when you use <code>get()</code> and <code>findBy*()</code>, or when you directly access the relation. That means you don&#8217;t have to worry at all about proxies in the majority of cases. But GORM doesn&#8217;t do that for objects returned with a query that returns a list, such as <code>list()</code> and <code>findAllBy\*()</code>. However, if Hibernate hasn&#8217;t attached the proxy to the session, those queries will return the real instances - hence why the last example works.</p>
</div>
<div class="paragraph">
<p>You can protect yourself to a degree from this problem by using the <code>instanceOf</code> method by GORM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> person = Person.get(<span class="integer">1</span>)
<span class="keyword">assert</span> Pet.list()[<span class="integer">0</span>].instanceOf(Dog)</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, it won&#8217;t help here if casting is involved. For example, the following code will throw a <code>ClassCastException</code> because the first pet in the list is a proxy instance with a class that is neither <code>Dog</code> nor a sub-class of <code>Dog</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> person = Person.get(<span class="integer">1</span>)
Dog pet = Pet.list()[<span class="integer">0</span>]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course, it&#8217;s best not to use static types in this situation. If you use an untyped variable for the pet instead, you can access any <code>Dog</code> properties or methods on the instance without any problems.</p>
</div>
<div class="paragraph">
<p>These days it&#8217;s rare that you will come across this issue, but it&#8217;s best to be aware of it just in case. At least you will know why such an error occurs and be able to work around it.</p>
</div>
</div>

<a name="5.5.2.9 Custom Cascade Behaviour"><!-- Legacy link --></a>
<h2 id="customCascadeBehaviour">7.5.2.9 Custom Cascade Behaviour</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl/customCascadeBehaviour.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>As described in the section on <a href="#cascades">cascading updates</a>, the primary mechanism to control the way updates and deletes cascade from one association to another is the static <a href="../ref/Domain%20Classes/belongsTo.html">belongsTo</a> property.</p>
</div>
<div class="paragraph">
<p>However, the ORM DSL gives you complete access to Hibernate&#8217;s <a href="http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/objectstate.html#objectstate-transitive">transitive persistence</a> capabilities using the <code>cascade</code> attribute.</p>
</div>
<div class="paragraph">
<p>Valid settings for the cascade attribute include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>merge</code> - merges the state of a detached association</p>
</li>
<li>
<p><code>save-update</code> - cascades only saves and updates to an association</p>
</li>
<li>
<p><code>delete</code> - cascades only deletes to an association</p>
</li>
<li>
<p><code>lock</code> - useful if a pessimistic lock should be cascaded to its associations</p>
</li>
<li>
<p><code>refresh</code> - cascades refreshes to an association</p>
</li>
<li>
<p><code>evict</code> - cascades evictions (equivalent to <code>discard()</code> in GORM) to associations if set</p>
</li>
<li>
<p><code>all</code> - cascade <em>all</em> operations to associations</p>
</li>
<li>
<p><code>all-delete-orphan</code> - Applies only to one-to-many associations and indicates that when a child is removed from an association then it should be automatically deleted. Children are also deleted when the parent is.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is advisable to read the section in the Hibernate documentation on <a href="http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/objectstate.html#objectstate-transitive">transitive persistence</a> to obtain a better understanding of the different cascade styles and recommendations for their usage
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To specify the cascade attribute simply define one or more (comma-separated) of the aforementioned settings as its value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {

    <span class="predefined-type">String</span> firstName

    <span class="directive">static</span> hasMany = [<span class="key">addresses</span>: Address]

    <span class="directive">static</span> mapping = {
        addresses <span class="key">cascade</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">all-delete-orphan</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Address</span> {
    <span class="predefined-type">String</span> street
    <span class="predefined-type">String</span> postCode
}</code></pre>
</div>
</div>

<a name="5.5.2.10 Custom Hibernate Types"><!-- Legacy link --></a>
<h2 id="customHibernateTypes">7.5.2.10 Custom Hibernate Types</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl/customHibernateTypes.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You saw in an earlier section that you can use composition (with the <code>embedded</code> property) to break a table into multiple objects. You can achieve a similar effect with Hibernate&#8217;s custom user types. These are not domain classes themselves, but plain Java or Groovy classes. Each of these types also has a corresponding "meta-type" class that implements <a href="http://docs.jboss.org/hibernate/orm/current/javadocs/org/hibernate/usertype/UserType.html">org.hibernate.usertype.UserType</a>.</p>
</div>
<div class="paragraph">
<p>The <a href="http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/mapping.html#mapping-types-custom">Hibernate reference manual</a> has some information on custom types, but here we will focus on how to map them in Grails. Let&#8217;s start by taking a look at a simple domain class that uses an old-fashioned (pre-Java 1.5) type-safe enum class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Book</span> {

    <span class="predefined-type">String</span> title
    <span class="predefined-type">String</span> author
    Rating rating

    <span class="directive">static</span> mapping = {
        rating <span class="key">type</span>: RatingUserType
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All we have done is declare the <code>rating</code> field the enum type and set the property&#8217;s type in the custom mapping to the corresponding <code>UserType</code> implementation. That&#8217;s all you have to do to start using your custom type. If you want, you can also use the other column settings such as "column" to change the column name and "index" to add it to an index.</p>
</div>
<div class="paragraph">
<p>Custom types aren&#8217;t limited to just a single column - they can be mapped to as many columns as you want. In such cases you explicitly define in the mapping what columns to use, since Hibernate can only use the property name for a single column. Fortunately, Grails lets you map multiple columns to a property using this syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Book</span> {

    <span class="predefined-type">String</span> title
    <span class="predefined-type">Name</span> author
    Rating rating

    <span class="directive">static</span> mapping = {
        author <span class="key">type</span>: NameUserType, {
            column <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">first_name</span><span class="delimiter">&quot;</span></span>
            column <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">last_name</span><span class="delimiter">&quot;</span></span>
        }
        rating <span class="key">type</span>: RatingUserType
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example will create "first_name" and "last_name" columns for the <code>author</code> property. You&#8217;ll be pleased to know that you can also use some of the normal column/property mapping attributes in the column definitions. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">column <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">first_name</span><span class="delimiter">&quot;</span></span>, <span class="key">index</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my_idx</span><span class="delimiter">&quot;</span></span>, <span class="key">unique</span>: <span class="predefined-constant">true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The column definitions do <em>not</em> support the following attributes: <code>type</code>, <code>cascade</code>, <code>lazy</code>, <code>cache</code>, and <code>joinTable</code>.</p>
</div>
<div class="paragraph">
<p>One thing to bear in mind with custom types is that they define the <em>SQL types</em> for the corresponding database columns. That helps take the burden of configuring them yourself, but what happens if you have a legacy database that uses a different SQL type for one of the columns? In that case, override the column&#8217;s SQL type using the <code>sqlType</code> attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Book</span> {

    <span class="predefined-type">String</span> title
    <span class="predefined-type">Name</span> author
    Rating rating

    <span class="directive">static</span> mapping = {
        author <span class="key">type</span>: NameUserType, {
            column <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">first_name</span><span class="delimiter">&quot;</span></span>, <span class="key">sqlType</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span>
            column <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">last_name</span><span class="delimiter">&quot;</span></span>, <span class="key">sqlType</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span>
        }
        rating <span class="key">type</span>: RatingUserType, <span class="key">sqlType</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Mind you, the SQL type you specify needs to still work with the custom type. So overriding a default of "varchar" with "text" is fine, but overriding "text" with "yes_no" isn&#8217;t going to work.</p>
</div>

<a name="5.5.2.11 Derived Properties"><!-- Legacy link --></a>
<h2 id="derivedProperties">7.5.2.11 Derived Properties</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl/derivedProperties.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>A derived property is one that takes its value from a SQL expression, often but not necessarily based on the value of one or more other persistent properties.  Consider a Product class like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Product</span> {
    <span class="predefined-type">Float</span> price
    <span class="predefined-type">Float</span> taxRate
    <span class="predefined-type">Float</span> tax
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>tax</code> property is derived based on the value of <code>price</code> and <code>taxRate</code> properties then is probably no need to persist the <code>tax</code> property.  The SQL used to derive the value of a derived property may be expressed in the ORM DSL like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Product</span> {
    <span class="predefined-type">Float</span> price
    <span class="predefined-type">Float</span> taxRate
    <span class="predefined-type">Float</span> tax

    <span class="directive">static</span> mapping = {
        tax <span class="key">formula</span>: <span class="string"><span class="delimiter">'</span><span class="content">PRICE * TAX_RATE</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the formula expressed in the ORM DSL is SQL so references to other properties should relate to the persistence model not the object model, which is why the example refers to <code>PRICE</code> and <code>TAX_RATE</code> instead of <code>price</code> and <code>taxRate</code>.</p>
</div>
<div class="paragraph">
<p>With that in place, when a Product is retrieved with something like <code>Product.get(42)</code>, the SQL that is generated to support that will look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">select
    product0_.id <span class="keyword">as</span> id1_0_,
    product0_.version <span class="keyword">as</span> version1_0_,
    product0_.price <span class="keyword">as</span> price1_0_,
    product0_.tax_rate <span class="keyword">as</span> tax4_1_0_,
    product0_.PRICE * product0_.TAX_RATE <span class="keyword">as</span> formula1_0_
from
    product product0_
where
    product0_.id=?</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the <code>tax</code> property is derived at runtime and not stored in the database it might seem that the same effect could be achieved by adding a method like <code>getTax()</code> to the <code>Product</code> class that simply returns the product of the <code>taxRate</code> and <code>price</code> properties.  With an approach like that you would give up the ability query the database based on the value of the <code>tax</code> property.  Using a derived property allows exactly that.  To retrieve all <code>Product</code> objects that have a <code>tax</code> value greater than 21.12 you could execute a query like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Product.findAllByTaxGreaterThan(<span class="float">21.12</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Derived properties may be referenced in the Criteria API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Product.withCriteria {
    gt <span class="string"><span class="delimiter">'</span><span class="content">tax</span><span class="delimiter">'</span></span>, <span class="float">21.12f</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The SQL that is generated to support either of those would look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">select
    this_.id <span class="keyword">as</span> id1_0_,
    this_.version <span class="keyword">as</span> version1_0_,
    this_.price <span class="keyword">as</span> price1_0_,
    this_.tax_rate <span class="keyword">as</span> tax4_1_0_,
    this_.PRICE * this_.TAX_RATE <span class="keyword">as</span> formula1_0_
from
    product this_
where
    this_.PRICE * this_.TAX_RATE&gt;?</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Because the value of a derived property is generated in the database and depends on the execution of SQL code, derived properties may not have GORM constraints applied to them.  If constraints are specified for a derived property, they will be ignored.
</td>
</tr>
</table>
</div>

<a name="5.5.2.12 Custom Naming Strategy"><!-- Legacy link --></a>
<h2 id="customNamingStrategy">7.5.2.12 Custom Naming Strategy</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/ormdsl/customNamingStrategy.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>By default Grails uses Hibernate&#8217;s <code>ImprovedNamingStrategy</code> to convert domain class Class and field names to SQL table and column names by converting from camel-cased Strings to ones that use underscores as word separators. You can customize these on a per-class basis in the <code>mapping</code> closure but if there&#8217;s a consistent pattern you can specify a different <code>NamingStrategy</code> class to use.</p>
</div>
<div class="paragraph">
<p>Configure the class name to be used in <code>grails-app/conf/application.groovy</code> in the <code>hibernate</code> section, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dataSource {
    pooled = <span class="predefined-constant">true</span>
    dbCreate = <span class="string"><span class="delimiter">&quot;</span><span class="content">create-drop</span><span class="delimiter">&quot;</span></span>
    ...
}

hibernate {
    cache.use_second_level_cache = <span class="predefined-constant">true</span>
    ...
    naming_strategy = com.myco.myproj.CustomNamingStrategy
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also specify the name of the class and it will be loaded for you:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">hibernate {
    ...
    naming_strategy = <span class="string"><span class="delimiter">'</span><span class="content">com.myco.myproj.CustomNamingStrategy</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A third option is to provide an instance if there is some configuration required beyond calling the default constructor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">hibernate {
    ...
    def strategy = <span class="keyword">new</span> com.myco.myproj.CustomNamingStrategy()
    <span class="comment">// configure as needed</span>
    naming_strategy = strategy
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use an existing class or write your own, for example one that prefixes table names and column names:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> com.myco.myproj

<span class="keyword">import</span> <span class="include">org.hibernate.cfg.ImprovedNamingStrategy</span>
<span class="keyword">import</span> <span class="include">org.hibernate.util.StringHelper</span>

<span class="type">class</span> <span class="class">CustomNamingStrategy</span> <span class="directive">extends</span> ImprovedNamingStrategy {

    <span class="predefined-type">String</span> classToTableName(<span class="predefined-type">String</span> className) {
        <span class="string"><span class="delimiter">&quot;</span><span class="content">table_</span><span class="delimiter">&quot;</span></span> + StringHelper.unqualify(className)
    }

    <span class="predefined-type">String</span> propertyToColumnName(<span class="predefined-type">String</span> propertyName) {
        <span class="string"><span class="delimiter">&quot;</span><span class="content">col_</span><span class="delimiter">&quot;</span></span> + StringHelper.unqualify(propertyName)
    }
}</code></pre>
</div>
</div>

<a name="5.5.3 Default Sort Order"><!-- Legacy link --></a>
<h2 id="defaultSortOrder">7.5.3 Default Sort Order</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/3.1.x/src/en/guide/GORM/advancedGORMFeatures/defaultSortOrder.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can sort objects using query arguments such as those found in the <a href="../ref/Domain%20Classes/list.html">list</a> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> airports = Airport.list(<span class="key">sort</span>:<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, you can also declare the default sort order for a collection in the mapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Airport</span> {
    ...
    static mapping = {
        sort <span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above means that all collections of <code>Airport</code> instances will by default be sorted by the airport name. If you also want to change the sort <em>order</em>, use this syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Airport</span> {
    ...
    static mapping = {
        sort <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">desc</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, you can configure sorting at the association level:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Airport</span> {
    ...
    static hasMany = [<span class="key">flights</span>: Flight]

    <span class="directive">static</span> mapping = {
        flights <span class="key">sort</span>: <span class="string"><span class="delimiter">'</span><span class="content">number</span><span class="delimiter">'</span></span>, <span class="key">order</span>: <span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the <code>flights</code> collection will always be sorted in descending order of flight number.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
These mappings will not work for default unidirectional one-to-many or many-to-many relationships because they involve a join table. See <a href="https://github.com/grails/grails-core/issues/3305">this issue</a> for more details. Consider using a <code>SortedSet</code> or queries with sort parameters to fetch the data you need.
</td>
</tr>
</table>
</div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../../guide/profiles.html">&lt;&lt; <strong>6</strong><span>Application Profiles</span></a></div>
                
                    <div class="toc-item next-right"><a href="../../guide/theWebLayer.html"><strong>8</strong><span>The Web Layer</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Command Line</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../../ref/Command%20Line/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/bug-report.html">bug-report</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/clean.html">clean</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/compile.html">compile</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/console.html">console</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-app.html">create-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-command.html">create-command</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-controller.html">create-controller</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-domain-class.html">create-domain-class</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-functional-test.html">create-functional-test</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-hibernate-cfg-xml.html">create-hibernate-cfg-xml</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-integration-test.html">create-integration-test</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-interceptor.html">create-interceptor</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-plugin.html">create-plugin</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-profile.html">create-profile</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-script.html">create-script</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-service.html">create-service</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-taglib.html">create-taglib</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-unit-test.html">create-unit-test</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/dependency-report.html">dependency-report</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/docs.html">docs</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/generate-all.html">generate-all</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/generate-controller.html">generate-controller</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/generate-views.html">generate-views</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/help.html">help</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/install-templates.html">install-templates</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/list-plugins.html">list-plugins</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/list-profiles.html">list-profiles</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/package-plugin.html">package-plugin</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/package.html">package</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/plugin-info.html">plugin-info</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/profile-info.html">profile-info</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/run-app.html">run-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/schema-export.html">schema-export</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/shell.html">shell</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/stats.html">stats</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/stop-app.html">stop-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/test-app.html">test-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/war.html">war</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Constraints</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../../ref/Constraints/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../../ref/Constraints/attributes.html">attributes</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/bindable.html">bindable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/blank.html">blank</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/creditCard.html">creditCard</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/email.html">email</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/inList.html">inList</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/matches.html">matches</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/max.html">max</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/maxSize.html">maxSize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/min.html">min</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/minSize.html">minSize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/notEqual.html">notEqual</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/nullable.html">nullable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/range.html">range</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/scale.html">scale</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/size.html">size</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/unique.html">unique</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/url.html">url</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/validator.html">validator</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Constraints/widget.html">widget</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Controllers</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../../ref/Controllers/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../../ref/Controllers/actionName.html">actionName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/allowedMethods.html">allowedMethods</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/bindData.html">bindData</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/chain.html">chain</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/controllerName.html">controllerName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/defaultAction.html">defaultAction</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/errors.html">errors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/flash.html">flash</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/forward.html">forward</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/grailsApplication.html">grailsApplication</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/hasErrors.html">hasErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/namespace.html">namespace</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/params.html">params</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/redirect.html">redirect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/render.html">render</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/request.html">request</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/respond.html">respond</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/response.html">response</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/responseFormats.html">responseFormats</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/scope.html">scope</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/servletContext.html">servletContext</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/session.html">session</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/withForm.html">withForm</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Controllers/withFormat.html">withFormat</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Database Mapping</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/autoImport.html">autoImport</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/autoTimestamp.html">autoTimestamp</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/batchSize.html">batchSize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/cache.html">cache</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/cascade.html">cascade</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/column.html">column</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/comment.html">comment</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/discriminator.html">discriminator</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/dynamicInsert.html">dynamicInsert</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/dynamicUpdate.html">dynamicUpdate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/fetch.html">fetch</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/id.html">id</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/ignoreNotFound.html">ignoreNotFound</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/indexColumn.html">indexColumn</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/insertable.html">insertable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/joinTable.html">joinTable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/lazy.html">lazy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/order.html">order</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/sort.html">sort</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/table.html">table</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/type.html">type</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/updateable.html">updateable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Database%20Mapping/version.html">version</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Domain Classes</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/addTo.html">addTo</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/attach.html">attach</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/belongsTo.html">belongsTo</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/clearErrors.html">clearErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/constraints.html">constraints</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/count.html">count</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/countBy.html">countBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/createCriteria.html">createCriteria</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/delete.html">delete</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/discard.html">discard</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/embedded.html">embedded</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/errors.html">errors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/executeQuery.html">executeQuery</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/executeUpdate.html">executeUpdate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/exists.html">exists</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/fetchMode.html">fetchMode</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/find.html">find</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/findAll.html">findAll</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/findAllBy.html">findAllBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/findAllWhere.html">findAllWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/findBy.html">findBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/findOrCreateBy.html">findOrCreateBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/findOrCreateWhere.html">findOrCreateWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/findOrSaveBy.html">findOrSaveBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/findOrSaveWhere.html">findOrSaveWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/findWhere.html">findWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/first.html">first</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/get.html">get</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/getAll.html">getAll</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/getDirtyPropertyNames.html">getDirtyPropertyNames</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/getPersistentValue.html">getPersistentValue</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/hasErrors.html">hasErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/hasMany.html">hasMany</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/hasOne.html">hasOne</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/ident.html">ident</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/instanceOf.html">instanceOf</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/isAttached.html">isAttached</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/isDirty.html">isDirty</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/last.html">last</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/list.html">list</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/listOrderBy.html">listOrderBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/load.html">load</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/lock.html">lock</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/mapWith.html">mapWith</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/mappedBy.html">mappedBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/mapping.html">mapping</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/merge.html">merge</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/namedQueries.html">namedQueries</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/properties.html">properties</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/read.html">read</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/refresh.html">refresh</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/removeFrom.html">removeFrom</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/save.html">save</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/transients.html">transients</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/validate.html">validate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/where.html">where</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/whereAny.html">whereAny</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/withCriteria.html">withCriteria</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/withNewSession.html">withNewSession</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/withSession.html">withSession</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Domain%20Classes/withTransaction.html">withTransaction</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Plug-ins</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../../ref/Plug-ins/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../../ref/Plug-ins/URL%20mappings.html">URL mappings</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Plug-ins/codecs.html">codecs</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Plug-ins/controllers.html">controllers</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Plug-ins/core.html">core</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Plug-ins/dataSource.html">dataSource</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Plug-ins/domainClasses.html">domainClasses</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Plug-ins/hibernate.html">hibernate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Plug-ins/i18n.html">i18n</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Plug-ins/logging.html">logging</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Plug-ins/scaffolding.html">scaffolding</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Plug-ins/services.html">services</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Plug-ins/servlets.html">servlets</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Services</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../../ref/Services/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../../ref/Services/scope.html">scope</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Services/transactional.html">transactional</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Servlet API</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../../ref/Servlet%20API/request.html">request</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Servlet%20API/response.html">response</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Servlet%20API/servletContext.html">servletContext</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Servlet%20API/session.html">session</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Tag Libraries</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../../ref/Tag%20Libraries/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../../ref/Tag%20Libraries/actionName.html">actionName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tag%20Libraries/controllerName.html">controllerName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tag%20Libraries/flash.html">flash</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tag%20Libraries/pageScope.html">pageScope</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tag%20Libraries/params.html">params</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tag%20Libraries/request.html">request</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tag%20Libraries/response.html">response</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tag%20Libraries/servletContext.html">servletContext</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tag%20Libraries/session.html">session</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Tags</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../../ref/Tags/actionSubmit.html">actionSubmit</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/actionSubmitImage.html">actionSubmitImage</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/applyLayout.html">applyLayout</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/checkBox.html">checkBox</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/collect.html">collect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/cookie.html">cookie</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/country.html">country</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/countrySelect.html">countrySelect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/createLink.html">createLink</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/createLinkTo.html">createLinkTo</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/currencySelect.html">currencySelect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/datePicker.html">datePicker</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/each.html">each</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/eachError.html">eachError</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/else.html">else</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/elseif.html">elseif</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/external.html">external</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/field.html">field</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/fieldError.html">fieldError</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/fieldValue.html">fieldValue</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/findAll.html">findAll</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/form.html">form</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/formatBoolean.html">formatBoolean</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/formatDate.html">formatDate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/formatNumber.html">formatNumber</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/grep.html">grep</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/hasErrors.html">hasErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/header.html">header</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/hiddenField.html">hiddenField</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/if.html">if</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/img.html">img</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/include.html">include</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/isAvailable.html">isAvailable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/isNotAvailable.html">isNotAvailable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/javascript.html">javascript</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/join.html">join</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/layoutBody.html">layoutBody</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/layoutHead.html">layoutHead</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/layoutTitle.html">layoutTitle</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/link.html">link</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/localeSelect.html">localeSelect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/message.html">message</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/meta.html">meta</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/pageProperty.html">pageProperty</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/paginate.html">paginate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/passwordField.html">passwordField</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/radio.html">radio</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/radioGroup.html">radioGroup</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/render.html">render</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/renderErrors.html">renderErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/resource.html">resource</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/select.html">select</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/set.html">set</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/sortableColumn.html">sortableColumn</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/submitButton.html">submitButton</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/textArea.html">textArea</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/textField.html">textField</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/timeZoneSelect.html">timeZoneSelect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/unless.html">unless</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/uploadForm.html">uploadForm</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/while.html">while</a>
                            </div>
                            
                            </div>
                    </div>
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically.
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
